<!DOCTYPE html>

<html lang="pl">

<head>

    <meta charset="UTF-8">

    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <title> Hello World</title>

</head>

<body>
<main id="top"> </main>

<div class="container" id="placeHolder"> </div>
<div class="container" id="placeHolder2"> </div>



<script type="text/babel">

    function App() {

        function Testing(Object) {
            if (Object == null)
            console.log("123");
            else
            console.log(Object);

            ReactDOM.render(
                <form>
                    <div class="form-group">
                        <label for="ID">Email address</label>
                        <input type="text" class="form-control" value={Object.id}/>

                        <label for="Name">Email address</label>
                        <input type="text" class="form-control" value={Object.name}/>

                        <label for="Description">Email address</label>
                        <input type="text" class="form-control" value={Object.description}/>
                    </div>
                </form>, document.getElementById("placeHolder2"));


        }


        async function testAuth(){

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const basicAuth = {
                username: username,
                password: password
            };

            await axios.get('http://localhost:8080/profile', {auth: basicAuth}).then(response => {
                ReactDOM.render(
                    <p> {response.data.name} </p>, document.getElementById("placeHolder2"));
            }).catch(err => {
                console.log(err)
            });


        }

        async function getInfo() {
            let id = document.getElementById('FirstSelect').value;
            console.log(id);
            await axios.get('https://localhost:7064/api/Items/' + id).then(response => {
                Testing(response.data)
            }).catch(err => {
                console.log(myerror)
            });
        }

        async function getInfos() {
            await axios.get('https://localhost:7064/api/Items/').then(response => {

                response.data.forEach((e) => {
                    const elements = response.data.map((item, index) => (<option value={item.id}>{item.name}</option>));
                    ReactDOM.render(
                        <select id="FirstSelect" class="form-select" onChange={getInfo}>{elements}</select>, document.getElementById('placeHolder'));
                })

                Testing(response.data[0]);


            }).catch(err => {
                console.log(myerror)
            });

        }

        return (



            <div class="container">

                <form>
                    <input type="text" id="username" placeholder="Username"/>
                    <input type="password" id="password" placeholder="Password"/>
                    <button type="button" class="btn btn-danger" onClick={testAuth}> Test Auth </button>
                </form>

                <button type="button" class="btn btn-primary" onClick={getInfos}> Odczytaj Dane </button>
            </div>
        );



    }

    const container = document.getElementById('top');
    const root = ReactDOM.createRoot(container);
    root.render(<App/>);

</script>

</body>

</html>